<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coconut Thickness Analyzer</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/fav.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° Font ‡∏ó‡∏µ‡πà‡∏´‡∏£‡∏π‡∏´‡∏£‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-brand">
            <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ -->
            <a href="{{ url_for('home') }}" class="brand-link">
                <img src="{{ url_for('static', filename='images/COCONUt THICKNET.png') }}" alt="Logo" class="navbar-logo">
                CocoThickness Analyzer
            </a>
        </div>
        <!-- Hamburger icon for mobile (will be hidden on desktop by CSS) -->
        <a href="javascript:void(0);" class="icon" onclick="toggleMenu()">
            <i class="fa fa-bars"></i>
        </a>
        <!-- Navigation links (will be hidden on mobile by CSS and toggled by JS) -->
        <div class="nav-links" id="myLinks">
            <a href="{{ url_for('home') }}">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            <a href="{{ url_for('analyzer_app') }}">‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß</a>
            <a href="{{ url_for('about') }}">‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</a>
            <a href="{{ url_for('contact') }}">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</a>
        </div>
    </nav>

    <div class="container">
        <h1>‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß</h1>
        <form id="uploadForm" method="post" action="/upload" enctype="multipart/form-data">
            <!-- START Custom File Input -->
            <div class="file-input-wrapper">
                <input type="file" name="file" id="fileUpload" accept="image/*" required>
                <button type="button" id="cameraBtn" class="custom-file-button camera-btn">üì∑ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Gallery -->
                <button type="button" id="galleryBtn" class="custom-file-button gallery-btn">üñºÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Gallery</button>
                <span id="fileNameDisplay" class="file-name-display">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
                <img id="imagePreview" class="image-preview" src="#" alt="Image Preview">
            </div>
            <!-- END Custom File Input -->
            
            <input type="submit" value="Upload and Analyze">
        </form>
<script>
const fileInput = document.getElementById('fileUpload');
const cameraBtn = document.getElementById('cameraBtn');
const galleryBtn = document.getElementById('galleryBtn');
const fileNameDisplay = document.getElementById('fileNameDisplay');
const imagePreview = document.getElementById('imagePreview');
const form = document.getElementById('uploadForm');

// ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á
cameraBtn.addEventListener('click', () => {
    fileInput.setAttribute('capture', 'environment'); // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
    fileInput.click();
});

// ‡∏õ‡∏∏‡πà‡∏° Gallery
galleryBtn.addEventListener('click', () => {
    fileInput.removeAttribute('capture'); // Gallery ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ capture
    fileInput.click();
});

// ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if(file){
        fileNameDisplay.textContent = file.name;
        const reader = new FileReader();
        reader.onload = function(e){
            imagePreview.src = e.target.result;
            imagePreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
    } else {
        fileNameDisplay.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å";
        imagePreview.style.display = "none";
        imagePreview.src = "#";
    }
});

</script>

        <!-- MODIFIED: Replaced loader -->
        <div id="spinnerContainer" class="spinner-container">
            <div aria-label="Orange and tan hamster running in a metal wheel" role="img" class="wheel-and-hamster">
                <div class="wheel"></div>
                <div class="hamster">
                    <div class="hamster__body">
                        <div class="hamster__head">
                            <div class="hamster__ear"></div>
                            <div class="hamster__eye"></div>
                            <div class="hamster__nose"></div>
                        </div>
                        <div class="hamster__limb hamster__limb--fr"></div>
                        <div class="hamster__limb hamster__limb--fl"></div>
                        <div class="hamster__limb hamster__limb--br"></div>
                        <div class="hamster__limb hamster__limb--bl"></div>
                        <div class="hamster__tail"></div>
                    </div>
                </div>
                <div class="spoke"></div>
            </div>
            <p class="processing-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏†‡∏≤‡∏û‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß...</p>
            <p class="percentage-text"><span id="progressPercentage">0</span>%</p>
        </div>

        {% if results %}
        <hr>
        <h2>Analysis Results:</h2>
        <div class="results-grid">
            <div class="image-display">
                <h3>Original Image</h3>
                <img src="{{ url_for('static', filename='results/' + results.original_image) }}" alt="Original Image">
            </div>

        </div>
        <div class="metrics">
            <h3>Metrics:</h3>
            <ul>
                <li><strong>Thickness (mm):</strong> {{ results['Calculated Thickness'] }}</li>
            </ul>
        </div>
        {% endif %}

    </div>

    <!-- START Footer Section -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section about">
                <h3>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö CocoThickness Analyzer</h3>
                <p>‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏†‡∏≤‡∏û ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï</p>
            </div>
            <div class="footer-section links">
                <h3>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πà‡∏ß‡∏ô</h3>
                <ul>
                    <li><a href="{{ url_for('home') }}">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
                    <li><a href="{{ url_for('analyzer_app') }}">‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß</a></li>
                    <li><a href="{{ url_for('about') }}">‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</a></li>
                    <li><a href="{{ url_for('contact') }}">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                </ul>
            </div>
            <div class="footer-section contact-info-footer">
                <h3>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
                <p><i class="fas fa-envelope"></i> 67pornchanok.hom@pccphet.ac.th</p>
                <p><i class="fas fa-phone-alt"></i> +66 61 626 7396</p>
                <p><i class="fab fa-line"></i> -</p>
                <!-- START Instagrams -->
                <p><i class="fab fa-instagram"></i> <a href="https://www.instagram.com/eveppp.h" target="_blank">@eveppp.h</a></p>
                <p><i class="fab fa-instagram"></i> <a href="https://www.instagram.com/puxncqz_" target="_blank">@puxncqz_</a></p>
                <p><i class="fab fa-instagram"></i> <a href="https://www.instagram.com/drx4.mmm_" target="_blank">@drx4.mmm_</a></p>
                <!-- END Instagrams -->
            </div>
        </div>
        <div class="footer-bottom">
            &copy; {{ now.year }} CocoThickness Analyzer. All rights reserved.
        </div>
    </footer>
    <!-- END Footer Section -->

    <script>
        // JavaScript ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Hamburger Menu (‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Mobile)
        function toggleMenu() {
            var x = document.getElementById("myLinks");
            if (x.classList.contains("active")) {
                x.classList.remove("active");
            } else {
                x.classList.add("active");
            }
        }

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô index.html)
        document.getElementById('uploadForm').addEventListener('submit', function() {
            document.getElementById('uploadForm').style.display = 'none';
            document.getElementById('spinnerContainer').style.display = 'flex';

            // Simulate progress percentage
            let percentage = 0;
            const progressElement = document.getElementById('progressPercentage');
            const interval = setInterval(() => {
                percentage += 1; // Increment by 1%
                if (percentage <= 99) { // Stop at 99% as 100% implies completion
                    progressElement.textContent = percentage;
                } else {
                    clearInterval(interval); // Stop the interval
                }
            }, 0); // Update every 150ms (0.15 seconds) -> ~15 seconds to reach 99%
        });

        // JavaScript ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Custom File Input ‡πÅ‡∏•‡∏∞ Image Preview
        document.getElementById('fileUpload').addEventListener('change', function() {
            const fileNameDisplay = document.getElementById('fileNameDisplay');
            const imagePreview = document.getElementById('imagePreview');

            if (this.files && this.files.length > 0) {
                const file = this.files[0];
                fileNameDisplay.textContent = file.name;
                fileNameDisplay.classList.add('selected');

                // Check if the selected file is an image
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result; // Set image source to data URL
                        imagePreview.style.display = 'block'; // Show the image preview
                    };
                    reader.readAsDataURL(file); // Read the file as a data URL
                } else {
                    // If not an image, hide preview and reset src
                    imagePreview.src = '#';
                    imagePreview.style.display = 'none';
                    fileNameDisplay.textContent = '‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û';
                    fileNameDisplay.classList.remove('selected');
                }
            } else {
                // If no file is selected, reset everything
                fileNameDisplay.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å';
                fileNameDisplay.classList.remove('selected');
                imagePreview.src = '#';
                imagePreview.style.display = 'none';
            }
        });
    </script>
</body>
</html>
